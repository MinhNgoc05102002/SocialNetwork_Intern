@{
    ViewData["Title"] = "Admin Page";
    Layout = null;
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using X.PagedList.Mvc.Core;
@model X.PagedList.IPagedList<Account>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Favicon -->
    <link href="/assets/images/favicon.png" rel="icon" type="image/png">

    <!-- Basic Page Needs
    ================================================== -->
    <title>Instello Sharing Photos</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Instello - Sharing Photos platform HTML Template">

    <!-- icons
    ================================================== -->
    <link rel="stylesheet" href="/assets/css/icons.css">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="/assets/css/uikit.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/tailwind.css">
    <link rel="stylesheet" href="/assets/css/chat.css">

    @*tạo tab bằng btrap*@
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        .admin-area {
            padding: 10px 30px;
            margin: 20px;
        }

        table {
            font-weight: 100px;
        }

        .tabs {
            display: flex;
            position: relative;
        }

            .tabs .line {
                position: absolute;
                left: 0;
                bottom: 0;
                width: 0;
                height: 6px;
                border-radius: 15px;
                background-color: #c23564;
                transition: all 0.2s ease;
            }

        .tab-item {
            min-width: 80px;
            padding: 16px 20px 11px 20px;
            font-size: 20px;
            text-align: center;
            color: #c23564;
            background-color: #fff;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            border-bottom: 5px solid transparent;
            opacity: 0.6;
            cursor: pointer;
            transition: all 0.5s ease;
        }

        .tab-icon {
            font-size: 24px;
            width: 32px;
            position: relative;
            top: 2px;
        }

        .tab-item:hover {
            opacity: 1;
            background-color: rgba(194, 53, 100, 0.05);
            border-color: rgba(194, 53, 100, 0.1);
        }

        .tab-item.active {
            opacity: 1;
        }

        .tab-content {
            padding: 28px 0;
        }

        .tab-pane {
            color: #333;
            display: none;
        }

            .tab-pane.active {
                display: block;
            }

            .tab-pane h2 {
                font-size: 24px;
                margin-bottom: 8px;
            }

        .header-table-radius-left {
            border-top-left-radius: 10px;
        }

        .header-table-radius-right {
            border-top-right-radius: 10px;
        }

        thead {
            background-color: #c23564;
            color: white;
        }

            thead tr th {
                border: 0px !important;
            }

        .border-right {
            border-right: 1px solid #dee2e6;
        }

        .border-left {
            border-left: 1px solid #dee2e6;
        }

        .center {
            color: #c23564;
            font-size: 18px;
            text-align: center;
        }

        .page-item .page-link {
            color: #c23564;
        }

        .pagination .active .page-link {
            background-color: #c23564;
            border-color: #c23564;
        }
    </style>
</head>

<body>


    <div id="wrapper">

        @await Html.PartialAsync("_PartialSidebar")

        <div class="main_content">

            <header>
                @await Html.PartialAsync("_PartialHeader")
            </header>

            <div class="admin-area  bg-white rounded-md lg:shadow-lg shadow">

                <div>
                    <!-- Tab items -->
                    <div class="tabs">
                        <div class="tab-item active">
                            <i class="tab-icon fas fa-user-alt"></i>
                            Account
                        </div>

                        <div class="line"></div>
                    </div>

                    <!-- Tab content -->
                    <div class="tab-content">
                        <div class="tab-pane active">
                            <p id="message-admin" class="alert-danger">

                            </p>
                            <table class="table table-striped table-hover table-responsive">
                                <thead>
                                    <tr>
                                        <th class="header-table-radius-left text-base"> ID </th>
                                        <th class="text-base"> @Html.DisplayNameFor(model => model[0].FullName)</th>
                                        <th class="text-base"> @Html.DisplayNameFor(model => model[0].DisplayName)</th>
                                        <th class="text-base"> @Html.DisplayNameFor(model => model[0].Email)</th>
                                        <th class="text-base"> @Html.DisplayNameFor(model => model[0].Location)</th>
                                        <th class="text-base"> @Html.DisplayNameFor(model => model[0].Phone)</th>
                                        @*<th class = "text-base"> @Html.DisplayNameFor(model => model[0].DayOfBirth)</th>*@
                                        <th class="text-base"> @Html.DisplayNameFor(model => model[0].Gender)</th>
                                        <th class="text-base"> Role</th>
                                        <th class="text-base">

                                        </th>
                                        <th class="header-table-radius-right text-base">
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model)
                                    {
                                        <tr>
                                            <td class="border-left font-medium">
                                                @Html.DisplayFor(modelItem => item.AccountId)
                                            </td>
                                            <td class="font-medium">
                                                @Html.DisplayFor(modelItem => item.FullName)
                                            </td>
                                            <td class="font-medium">
                                                @Html.DisplayFor(modelItem => item.DisplayName)
                                            </td>
                                            <td class="font-medium">
                                                @Html.DisplayFor(modelItem => item.Email)
                                            </td>
                                            <td class="font-medium">
                                                @Html.DisplayFor(modelItem => item.Location)
                                            </td>
                                            <td class="font-medium">
                                                @Html.DisplayFor(modelItem => item.Phone)
                                            </td>
                                            @{
                                                string role = "user";
                                                string cls = "";
                                                if (item.IsAdmin == true)
                                                {
                                                    role = "admin";
                                                    cls = "success";
                                                }

                                            }
                                            @{
                                                string gender = "venus";
                                                if (item.Gender == true)
                                                    gender = "mars";

                                            }
                                            <td class="center font-medium">
                                                <i class="fa-solid fa-@gender"></i>
                                            </td>
                                            <td class="font-medium">
                                                <button type="button" class="btn btn-@cls btn-sm">@role</button>
                                            </td>
                                            @{
                                                string accStatus = "ban";
                                                string clss = "dark";

                                                if (item.IsBanned == true)
                                                {
                                                    accStatus = "banned";
                                                    clss = "danger";
                                                }
                                            }
                                            <td class="font-medium">
                                                <a href="/admin/BanAccount?accountId=@item.AccountId" onclick="handleBanAccount(event, @item.AccountId)" class="btn btn-outline-@clss btn-sm" role="button">@accStatus</a>
                                            </td>
                                            <td class="border-right font-medium">
                                                <a href="/account/profile?accountid=@item.AccountId" style="border-color: #c23564; background-color: #c23564;" class="btn btn-info btn-sm" role="button">view detail</a>
                                            </td>
                                        </tr>
                                    }

                                </tbody>
                            </table>

                            <ul class="pagination justify-content-center">
                                @Html.PagedListPager(Model,page => Url.Action("index", new {page=page}),new X.PagedList.Web.Common.PagedListRenderOptions(){
                                LiElementClasses = new List<String> {"page-item"},
                                PageClasses = new List<String> {"page-link"}
                                })
                            </ul>
                        </div>

                    </div>
                </div>

            </div>
        </div>

    </div>

    <script>
        //const $ = document.querySelector.bind(document)
        //const $$ = document.querySelectorAll.bind(document)

        const tabs = document.querySelectorAll('.tab-item')
        const panes = document.querySelectorAll('.tab-pane')

        const tabActive = document.querySelector('.tab-item.active')
        const line = document.querySelector('.tabs .line')

        line.style.left = tabActive.offsetLeft + 'px'
        line.style.width = tabActive.offsetWidth + 'px'


        tabs.forEach((tab, index) => {
            const pane = panes[index]

            tab.onclick = function () {
                // chọn phần tử có class là tab-item, phần tử con là .active,
                document.querySelector('.tab-item.active').classList.remove('active')
                document.querySelector('.tab-pane.active').classList.remove('active')

                line.style.left = tab.offsetLeft + 'px'
                line.style.width = tab.offsetWidth + 'px'

                this.classList.add('active')
                pane.classList.add('active')
            }
        })
    </script>

    <script>
            //Dark mode
            (function (window, document, undefined) {
                'use strict';
                if (!('localStorage' in window)) return;
                var nightMode = localStorage.getItem('gmtNightMode');
                if (nightMode) {
                    document.documentElement.className += ' dark';
                }
            })(window, document);


        (function (window, document, undefined) {

            'use strict';

            // Feature test
            if (!('localStorage' in window)) return;

            // Get our newly insert toggle
            var nightMode = document.querySelector('#night-mode');
            if (!nightMode) return;

            // When clicked, toggle night mode on or off
            nightMode.addEventListener('click', function (event) {
                event.preventDefault();
                document.documentElement.classList.toggle('dark');
                if (document.documentElement.classList.contains('dark')) {
                    localStorage.setItem('gmtNightMode', true);
                    return;
                }
                localStorage.removeItem('gmtNightMode');
            }, false);

        })(window, document);
    </script>

    <!-- Scripts
       ================================================== -->
    <script src="/assets/js/tippy.all.min.js"></script>
    <script src="/assets/js/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/uikit.js"></script>
    <script src="/assets/js/simplebar.js"></script>
    <script src="/assets/js/custom.js"></script>


    <script src="https://unpkg.com/ionicons@5.2.3/dist/ionicons.js"></script>
    <script src="https://kit.fontawesome.com/bda3bb47f4.js" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js" integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD" crossorigin="anonymous"></script>


    <script>
        function handleBanAccount(event, accountId) {
            event.preventDefault();
            $.ajax({
                type: 'PUT',
                url: `https://localhost:7150/admin/BanAccount?accountId=${accountId}`,
                dataType: 'json',
                success: function (data) {
                    var messageElem = document.getElementById('message-admin');
                    messageElem.innerHTML = data.message;
                    setTimeout(() => {
                        messageElem.innerHTML = "";
                    }, 2000);
                    if (data.status == true) {
                        if (data.isBan == true) {
                            event.target.innerHTML = "banned";
                            if (event.target.classList.contains('btn-outline-dark')) {
                                event.target.classList.remove('btn-outline-dark')
                            }
                            event.target.classList.add('btn-outline-danger')
                        }
                        else {
                            event.target.innerHTML = "ban";
                            if (event.target.classList.contains('btn-outline-danger')) {
                                event.target.classList.remove('btn-outline-danger')
                            }
                            event.target.classList.add('btn-outline-dark')
                        }

                    }
                },
                error: function (xhr) {
                    alert(xhr.responseText);
                }
            })
        }
    </script>

</body>


</html>

<style>
    .nav-link {
        color: black;
    }

</style>